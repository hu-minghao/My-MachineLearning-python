from sklearn import datasets
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt
from sklearn.metrics import silhouette_score
from sklearn.metrics import calinski_harabaz_score
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split
from sklearn.externals import joblib
sc=StandardScaler()
'''载入wine数据'''
n_cluster=[]
intera=[]
silhouette=[]
wine= datasets.load_wine()
data=sc.fit_transform(wine.data)
train_x,test_x,train_y,test_y=train_test_split(data,wine.target,test_size=0.1,random_state=18)
model=KMeans(n_clusters=3)
model.fit(train_x)
joblib.dump(model,'./wine_KMeans.pkl')
clf=joblib.load('wine_KMeans.pkl')
y_pre=clf.predict(data)
print('准确率为：',(y_pre==wine.target).sum()/len(wine.target))

结果准确率：准确率为： 0.9719101123595506
